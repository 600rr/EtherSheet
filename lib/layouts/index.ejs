<html>
  <head>
    <title>Ethersheet</title>
    <script type="text/javascript" src="/es_client/vendor/sjcl.js"></script>
    <script type="text/javascript">sjcl.random.startCollectors();</script>
    <link href='/es_client/styles/fonts.css' rel='stylesheet' type='text/css'>
    <link href='/es_client/styles/style.css' rel='stylesheet' type='text/css'>
  </head>
  <body>
    <div id='content-outer'>
      <div id='content-inner'>
        <div id='logo-container'>
          <img src="/es_client/icons/es_logo.png">
        </div>
        <div id='instructions-container'>
	        <p id='instructions' class='text'>
	          Name your spreadsheet
	        </p>
	        <form onsubmit="setSessionCookie();go2Name();return false;" action="#"> 
	          <div id="input_border" class='text'>
	            <input type="text" autofocus="" id="sheetname"> 
	            <input type="submit" value="Go to the sheet" id='submit'> 
	          </div>
	        </form>
        <div id='about' class='text'>
	        <p>Ethersheet is an open source tool to make collaborating on spreadsheets fast, easy and secure.
					</p>
	        <p>Ethersheet does not store IP addresses and we require https 
	connections. For added anonymity we suggest that you use this service 
	over <a href="https://torproject.org/">TOR</a>.  </p>
	        If you want to find out more, report bugs, or contirbute code, visit the <a href="https://github.com/ethersheet-collective">Github Page</a>. 
	        <p>This service should be considered alpha and should not be used where stability and security are requirement.</p>
        </div>
	      </div>
      </div>
    </div>
  <script type='text/javascript'>
  function setSessionCookie(){
    var sheetname = document.getElementById("sheetname").value;
    document.cookie = "JSESSIONID=" + sheetname + "; secure" 
  }

  //js code stolen from etherpad http://etherpad.org/  Thanks!!!
    function go2Name() {
      var sheetname = document.getElementById("sheetname").value;
      sheetname.length > 0 ? window.location = "s/" + sheetname : alert("Please enter a name")
    }

    function setRandomName() {
      document.getElementById("sheetname").value = randomString(20);
    }
    function randomString(strlen) {
      var chars = "0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";
      var string_length = strlen || 12;
      var randomstring = '';
      var words = sjcl.random.randomWords(string_length);
      for (var i = 0; i < string_length; i++) {
        var rnum = Math.abs(words.pop() % chars.length);
        randomstring += chars.substring(rnum, rnum + 1);
      }
      return randomstring;
    }

    setRandomName();

  </script>
  </body>
</html>
